(function(){function a(a){function b(b,c,d,e,f,g){for(;f>=0&&g>f;f+=a){var h=e?e[f]:f;d=c(d,b[h],h,b)}return d}return function(c,d,e,f){d=t(d,f,4);var g=!A(c)&&s.keys(c),h=(g||c).length,i=a>0?0:h-1;return arguments.length<3&&(e=c[g?g[i]:i],i+=a),b(c,d,e,g,i,h)}}function b(a){return function(b,c,d){c=u(c,d);for(var e=z(b),f=a>0?0:e-1;f>=0&&e>f;f+=a)if(c(b[f],f,b))return f;return-1}}function c(a,b,c){return function(d,e,f){var g=0,h=z(d);if("number"==typeof f)a>0?g=f>=0?f:Math.max(f+h,g):h=f>=0?Math.min(f+1,h):f+h+1;else if(c&&f&&h)return f=c(d,e),d[f]===e?f:-1;if(e!==e)return f=b(k.call(d,g,h),s.isNaN),f>=0?f+g:-1;for(f=a>0?g:h-1;f>=0&&h>f;f+=a)if(d[f]===e)return f;return-1}}function d(a,b){var c=F.length,d=a.constructor,e=s.isFunction(d)&&d.prototype||h,f="constructor";for(s.has(a,f)&&!s.contains(b,f)&&b.push(f);c--;)f=F[c],f in a&&a[f]!==e[f]&&!s.contains(b,f)&&b.push(f)}var e=this,f=e._,g=Array.prototype,h=Object.prototype,i=Function.prototype,j=g.push,k=g.slice,l=h.toString,m=h.hasOwnProperty,n=Array.isArray,o=Object.keys,p=i.bind,q=Object.create,r=function(){},s=function(a){return a instanceof s?a:this instanceof s?void(this._wrapped=a):new s(a)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=s),exports._=s):e._=s,s.VERSION="1.8.3";var t=function(a,b,c){if(void 0===b)return a;switch(null==c?3:c){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,e){return a.call(b,c,d,e)};case 4:return function(c,d,e,f){return a.call(b,c,d,e,f)}}return function(){return a.apply(b,arguments)}},u=function(a,b,c){return null==a?s.identity:s.isFunction(a)?t(a,b,c):s.isObject(a)?s.matcher(a):s.property(a)};s.iteratee=function(a,b){return u(a,b,1/0)};var v=function(a,b){return function(c){var d=arguments.length;if(2>d||null==c)return c;for(var e=1;d>e;e++)for(var f=arguments[e],g=a(f),h=g.length,i=0;h>i;i++){var j=g[i];b&&void 0!==c[j]||(c[j]=f[j])}return c}},w=function(a){if(!s.isObject(a))return{};if(q)return q(a);r.prototype=a;var b=new r;return r.prototype=null,b},x=function(a){return function(b){return null==b?void 0:b[a]}},y=Math.pow(2,53)-1,z=x("length"),A=function(a){var b=z(a);return"number"==typeof b&&b>=0&&y>=b};s.each=s.forEach=function(a,b,c){b=t(b,c);var d,e;if(A(a))for(d=0,e=a.length;e>d;d++)b(a[d],d,a);else{var f=s.keys(a);for(d=0,e=f.length;e>d;d++)b(a[f[d]],f[d],a)}return a},s.map=s.collect=function(a,b,c){b=u(b,c);for(var d=!A(a)&&s.keys(a),e=(d||a).length,f=Array(e),g=0;e>g;g++){var h=d?d[g]:g;f[g]=b(a[h],h,a)}return f},s.reduce=s.foldl=s.inject=a(1),s.reduceRight=s.foldr=a(-1),s.find=s.detect=function(a,b,c){var d;return d=A(a)?s.findIndex(a,b,c):s.findKey(a,b,c),void 0!==d&&d!==-1?a[d]:void 0},s.filter=s.select=function(a,b,c){var d=[];return b=u(b,c),s.each(a,function(a,c,e){b(a,c,e)&&d.push(a)}),d},s.reject=function(a,b,c){return s.filter(a,s.negate(u(b)),c)},s.every=s.all=function(a,b,c){b=u(b,c);for(var d=!A(a)&&s.keys(a),e=(d||a).length,f=0;e>f;f++){var g=d?d[f]:f;if(!b(a[g],g,a))return!1}return!0},s.some=s.any=function(a,b,c){b=u(b,c);for(var d=!A(a)&&s.keys(a),e=(d||a).length,f=0;e>f;f++){var g=d?d[f]:f;if(b(a[g],g,a))return!0}return!1},s.contains=s.includes=s.include=function(a,b,c,d){return A(a)||(a=s.values(a)),("number"!=typeof c||d)&&(c=0),s.indexOf(a,b,c)>=0},s.invoke=function(a,b){var c=k.call(arguments,2),d=s.isFunction(b);return s.map(a,function(a){var e=d?b:a[b];return null==e?e:e.apply(a,c)})},s.pluck=function(a,b){return s.map(a,s.property(b))},s.where=function(a,b){return s.filter(a,s.matcher(b))},s.findWhere=function(a,b){return s.find(a,s.matcher(b))},s.max=function(a,b,c){var d,e,f=-1/0,g=-1/0;if(null==b&&null!=a){a=A(a)?a:s.values(a);for(var h=0,i=a.length;i>h;h++)d=a[h],d>f&&(f=d)}else b=u(b,c),s.each(a,function(a,c,d){e=b(a,c,d),(e>g||e===-1/0&&f===-1/0)&&(f=a,g=e)});return f},s.min=function(a,b,c){var d,e,f=1/0,g=1/0;if(null==b&&null!=a){a=A(a)?a:s.values(a);for(var h=0,i=a.length;i>h;h++)d=a[h],f>d&&(f=d)}else b=u(b,c),s.each(a,function(a,c,d){e=b(a,c,d),(g>e||1/0===e&&1/0===f)&&(f=a,g=e)});return f},s.shuffle=function(a){for(var b,c=A(a)?a:s.values(a),d=c.length,e=Array(d),f=0;d>f;f++)b=s.random(0,f),b!==f&&(e[f]=e[b]),e[b]=c[f];return e},s.sample=function(a,b,c){return null==b||c?(A(a)||(a=s.values(a)),a[s.random(a.length-1)]):s.shuffle(a).slice(0,Math.max(0,b))},s.sortBy=function(a,b,c){return b=u(b,c),s.pluck(s.map(a,function(a,c,d){return{value:a,index:c,criteria:b(a,c,d)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(d>c||void 0===d)return-1}return a.index-b.index}),"value")};var B=function(a){return function(b,c,d){var e={};return c=u(c,d),s.each(b,function(d,f){var g=c(d,f,b);a(e,d,g)}),e}};s.groupBy=B(function(a,b,c){s.has(a,c)?a[c].push(b):a[c]=[b]}),s.indexBy=B(function(a,b,c){a[c]=b}),s.countBy=B(function(a,b,c){s.has(a,c)?a[c]++:a[c]=1}),s.toArray=function(a){return a?s.isArray(a)?k.call(a):A(a)?s.map(a,s.identity):s.values(a):[]},s.size=function(a){return null==a?0:A(a)?a.length:s.keys(a).length},s.partition=function(a,b,c){b=u(b,c);var d=[],e=[];return s.each(a,function(a,c,f){(b(a,c,f)?d:e).push(a)}),[d,e]},s.first=s.head=s.take=function(a,b,c){return null==a?void 0:null==b||c?a[0]:s.initial(a,a.length-b)},s.initial=function(a,b,c){return k.call(a,0,Math.max(0,a.length-(null==b||c?1:b)))},s.last=function(a,b,c){return null==a?void 0:null==b||c?a[a.length-1]:s.rest(a,Math.max(0,a.length-b))},s.rest=s.tail=s.drop=function(a,b,c){return k.call(a,null==b||c?1:b)},s.compact=function(a){return s.filter(a,s.identity)};var C=function(a,b,c,d){for(var e=[],f=0,g=d||0,h=z(a);h>g;g++){var i=a[g];if(A(i)&&(s.isArray(i)||s.isArguments(i))){b||(i=C(i,b,c));var j=0,k=i.length;for(e.length+=k;k>j;)e[f++]=i[j++]}else c||(e[f++]=i)}return e};s.flatten=function(a,b){return C(a,b,!1)},s.without=function(a){return s.difference(a,k.call(arguments,1))},s.uniq=s.unique=function(a,b,c,d){s.isBoolean(b)||(d=c,c=b,b=!1),null!=c&&(c=u(c,d));for(var e=[],f=[],g=0,h=z(a);h>g;g++){var i=a[g],j=c?c(i,g,a):i;b?(g&&f===j||e.push(i),f=j):c?s.contains(f,j)||(f.push(j),e.push(i)):s.contains(e,i)||e.push(i)}return e},s.union=function(){return s.uniq(C(arguments,!0,!0))},s.intersection=function(a){for(var b=[],c=arguments.length,d=0,e=z(a);e>d;d++){var f=a[d];if(!s.contains(b,f)){for(var g=1;c>g&&s.contains(arguments[g],f);g++);g===c&&b.push(f)}}return b},s.difference=function(a){var b=C(arguments,!0,!0,1);return s.filter(a,function(a){return!s.contains(b,a)})},s.zip=function(){return s.unzip(arguments)},s.unzip=function(a){for(var b=a&&s.max(a,z).length||0,c=Array(b),d=0;b>d;d++)c[d]=s.pluck(a,d);return c},s.object=function(a,b){for(var c={},d=0,e=z(a);e>d;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c},s.findIndex=b(1),s.findLastIndex=b(-1),s.sortedIndex=function(a,b,c,d){c=u(c,d,1);for(var e=c(b),f=0,g=z(a);g>f;){var h=Math.floor((f+g)/2);c(a[h])<e?f=h+1:g=h}return f},s.indexOf=c(1,s.findIndex,s.sortedIndex),s.lastIndexOf=c(-1,s.findLastIndex),s.range=function(a,b,c){null==b&&(b=a||0,a=0),c=c||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=Array(d),f=0;d>f;f++,a+=c)e[f]=a;return e};var D=function(a,b,c,d,e){if(!(d instanceof b))return a.apply(c,e);var f=w(a.prototype),g=a.apply(f,e);return s.isObject(g)?g:f};s.bind=function(a,b){if(p&&a.bind===p)return p.apply(a,k.call(arguments,1));if(!s.isFunction(a))throw new TypeError("Bind must be called on a function");var c=k.call(arguments,2),d=function(){return D(a,d,b,this,c.concat(k.call(arguments)))};return d},s.partial=function(a){var b=k.call(arguments,1),c=function(){for(var d=0,e=b.length,f=Array(e),g=0;e>g;g++)f[g]=b[g]===s?arguments[d++]:b[g];for(;d<arguments.length;)f.push(arguments[d++]);return D(a,c,this,this,f)};return c},s.bindAll=function(a){var b,c,d=arguments.length;if(1>=d)throw new Error("bindAll must be passed function names");for(b=1;d>b;b++)c=arguments[b],a[c]=s.bind(a[c],a);return a},s.memoize=function(a,b){var c=function(d){var e=c.cache,f=""+(b?b.apply(this,arguments):d);return s.has(e,f)||(e[f]=a.apply(this,arguments)),e[f]};return c.cache={},c},s.delay=function(a,b){var c=k.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)},s.defer=s.partial(s.delay,s,1),s.throttle=function(a,b,c){var d,e,f,g=null,h=0;c||(c={});var i=function(){h=c.leading===!1?0:s.now(),g=null,f=a.apply(d,e),g||(d=e=null)};return function(){var j=s.now();h||c.leading!==!1||(h=j);var k=b-(j-h);return d=this,e=arguments,0>=k||k>b?(g&&(clearTimeout(g),g=null),h=j,f=a.apply(d,e),g||(d=e=null)):g||c.trailing===!1||(g=setTimeout(i,k)),f}},s.debounce=function(a,b,c){var d,e,f,g,h,i=function(){var j=s.now()-g;b>j&&j>=0?d=setTimeout(i,b-j):(d=null,c||(h=a.apply(f,e),d||(f=e=null)))};return function(){f=this,e=arguments,g=s.now();var j=c&&!d;return d||(d=setTimeout(i,b)),j&&(h=a.apply(f,e),f=e=null),h}},s.wrap=function(a,b){return s.partial(b,a)},s.negate=function(a){return function(){return!a.apply(this,arguments)}},s.compose=function(){var a=arguments,b=a.length-1;return function(){for(var c=b,d=a[b].apply(this,arguments);c--;)d=a[c].call(this,d);return d}},s.after=function(a,b){return function(){return--a<1?b.apply(this,arguments):void 0}},s.before=function(a,b){var c;return function(){return--a>0&&(c=b.apply(this,arguments)),1>=a&&(b=null),c}},s.once=s.partial(s.before,2);var E=!{toString:null}.propertyIsEnumerable("toString"),F=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];s.keys=function(a){if(!s.isObject(a))return[];if(o)return o(a);var b=[];for(var c in a)s.has(a,c)&&b.push(c);return E&&d(a,b),b},s.allKeys=function(a){if(!s.isObject(a))return[];var b=[];for(var c in a)b.push(c);return E&&d(a,b),b},s.values=function(a){for(var b=s.keys(a),c=b.length,d=Array(c),e=0;c>e;e++)d[e]=a[b[e]];return d},s.mapObject=function(a,b,c){b=u(b,c);for(var d,e=s.keys(a),f=e.length,g={},h=0;f>h;h++)d=e[h],g[d]=b(a[d],d,a);return g},s.pairs=function(a){for(var b=s.keys(a),c=b.length,d=Array(c),e=0;c>e;e++)d[e]=[b[e],a[b[e]]];return d},s.invert=function(a){for(var b={},c=s.keys(a),d=0,e=c.length;e>d;d++)b[a[c[d]]]=c[d];return b},s.functions=s.methods=function(a){var b=[];for(var c in a)s.isFunction(a[c])&&b.push(c);return b.sort()},s.extend=v(s.allKeys),s.extendOwn=s.assign=v(s.keys),s.findKey=function(a,b,c){b=u(b,c);for(var d,e=s.keys(a),f=0,g=e.length;g>f;f++)if(d=e[f],b(a[d],d,a))return d},s.pick=function(a,b,c){var d,e,f={},g=a;if(null==g)return f;s.isFunction(b)?(e=s.allKeys(g),d=t(b,c)):(e=C(arguments,!1,!1,1),d=function(a,b,c){return b in c},g=Object(g));for(var h=0,i=e.length;i>h;h++){var j=e[h],k=g[j];d(k,j,g)&&(f[j]=k)}return f},s.omit=function(a,b,c){if(s.isFunction(b))b=s.negate(b);else{var d=s.map(C(arguments,!1,!1,1),String);b=function(a,b){return!s.contains(d,b)}}return s.pick(a,b,c)},s.defaults=v(s.allKeys,!0),s.create=function(a,b){var c=w(a);return b&&s.extendOwn(c,b),c},s.clone=function(a){return s.isObject(a)?s.isArray(a)?a.slice():s.extend({},a):a},s.tap=function(a,b){return b(a),a},s.isMatch=function(a,b){var c=s.keys(b),d=c.length;if(null==a)return!d;for(var e=Object(a),f=0;d>f;f++){var g=c[f];if(b[g]!==e[g]||!(g in e))return!1}return!0};var G=function(a,b,c,d){if(a===b)return 0!==a||1/a===1/b;if(null==a||null==b)return a===b;a instanceof s&&(a=a._wrapped),b instanceof s&&(b=b._wrapped);var e=l.call(a);if(e!==l.call(b))return!1;switch(e){case"[object RegExp]":case"[object String]":return""+a==""+b;case"[object Number]":return+a!==+a?+b!==+b:0===+a?1/+a===1/b:+a===+b;case"[object Date]":case"[object Boolean]":return+a===+b}var f="[object Array]"===e;if(!f){if("object"!=typeof a||"object"!=typeof b)return!1;var g=a.constructor,h=b.constructor;if(g!==h&&!(s.isFunction(g)&&g instanceof g&&s.isFunction(h)&&h instanceof h)&&"constructor"in a&&"constructor"in b)return!1}c=c||[],d=d||[];for(var i=c.length;i--;)if(c[i]===a)return d[i]===b;if(c.push(a),d.push(b),f){if(i=a.length,i!==b.length)return!1;for(;i--;)if(!G(a[i],b[i],c,d))return!1}else{var j,k=s.keys(a);if(i=k.length,s.keys(b).length!==i)return!1;for(;i--;)if(j=k[i],!s.has(b,j)||!G(a[j],b[j],c,d))return!1}return c.pop(),d.pop(),!0};s.isEqual=function(a,b){return G(a,b)},s.isEmpty=function(a){return null==a||(A(a)&&(s.isArray(a)||s.isString(a)||s.isArguments(a))?0===a.length:0===s.keys(a).length)},s.isElement=function(a){return!(!a||1!==a.nodeType)},s.isArray=n||function(a){return"[object Array]"===l.call(a)},s.isObject=function(a){var b=typeof a;return"function"===b||"object"===b&&!!a},s.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(a){s["is"+a]=function(b){return l.call(b)==="[object "+a+"]"}}),s.isArguments(arguments)||(s.isArguments=function(a){return s.has(a,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(s.isFunction=function(a){return"function"==typeof a||!1}),s.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},s.isNaN=function(a){return s.isNumber(a)&&a!==+a},s.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"===l.call(a)},s.isNull=function(a){return null===a},s.isUndefined=function(a){return void 0===a},s.has=function(a,b){return null!=a&&m.call(a,b)},s.noConflict=function(){return e._=f,this},s.identity=function(a){return a},s.constant=function(a){return function(){return a}},s.noop=function(){},s.property=x,s.propertyOf=function(a){return null==a?function(){}:function(b){return a[b]}},s.matcher=s.matches=function(a){return a=s.extendOwn({},a),function(b){return s.isMatch(b,a)}},s.times=function(a,b,c){var d=Array(Math.max(0,a));b=t(b,c,1);for(var e=0;a>e;e++)d[e]=b(e);return d},s.random=function(a,b){return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))},s.now=Date.now||function(){return(new Date).getTime()};var H={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},I=s.invert(H),J=function(a){var b=function(b){return a[b]},c="(?:"+s.keys(a).join("|")+")",d=RegExp(c),e=RegExp(c,"g");return function(a){return a=null==a?"":""+a,d.test(a)?a.replace(e,b):a}};s.escape=J(H),s.unescape=J(I),s.result=function(a,b,c){var d=null==a?void 0:a[b];return void 0===d&&(d=c),s.isFunction(d)?d.call(a):d};var K=0;s.uniqueId=function(a){var b=++K+"";return a?a+b:b},s.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var L=/(.)^/,M={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},N=/\\|'|\r|\n|\u2028|\u2029/g,O=function(a){return"\\"+M[a]};s.template=function(a,b,c){!b&&c&&(b=c),b=s.defaults({},b,s.templateSettings);var d=RegExp([(b.escape||L).source,(b.interpolate||L).source,(b.evaluate||L).source].join("|")+"|$","g"),e=0,f="__p+='";a.replace(d,function(b,c,d,g,h){return f+=a.slice(e,h).replace(N,O),e=h+b.length,c?f+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'":d?f+="'+\n((__t=("+d+"))==null?'':__t)+\n'":g&&(f+="';\n"+g+"\n__p+='"),b}),f+="';\n",b.variable||(f="with(obj||{}){\n"+f+"}\n"),f="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+f+"return __p;\n";try{var g=new Function(b.variable||"obj","_",f)}catch(a){throw a.source=f,a}var h=function(a){return g.call(this,a,s)},i=b.variable||"obj";return h.source="function("+i+"){\n"+f+"}",h},s.chain=function(a){var b=s(a);return b._chain=!0,b};var P=function(a,b){return a._chain?s(b).chain():b};s.mixin=function(a){s.each(s.functions(a),function(b){var c=s[b]=a[b];s.prototype[b]=function(){var a=[this._wrapped];return j.apply(a,arguments),P(this,c.apply(s,a))}})},s.mixin(s),s.each(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=g[a];s.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),"shift"!==a&&"splice"!==a||0!==c.length||delete c[0],P(this,c)}}),s.each(["concat","join","slice"],function(a){var b=g[a];s.prototype[a]=function(){return P(this,b.apply(this._wrapped,arguments))}}),s.prototype.value=function(){return this._wrapped},s.prototype.valueOf=s.prototype.toJSON=s.prototype.value,s.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return s})}).call(this);var vejs=function(){"use strict";function a(a){return function(){var e,b="["+(a?a+":":"")+arguments[0]+"] ",c=arguments[1],d=arguments;return e=b+c.replace(/\{\d+\}/g,function(a){var c,b=+a.slice(1,-1);return b+2<d.length?(c=d[b+2],isFunction(c)?c.toString().replace(/ \{[\s\S]*$/,""):isUndefined(c)?"undefined":f(c)?c:toJson(c)):a}),new Error(e)}}function i(){return Object.create(null)}function k(a){return a+""}function p(a,b){return"undefined"!=typeof a?a:b}function q(a,b){return"undefined"==typeof a?b:"undefined"==typeof b?a:a+b}function t(a){return a.type===o.Identifier||a.type===o.MemberExpression}function u(a){if(1===a.body.length&&t(a.body[0].expression))return{type:o.AssignmentExpression,left:a.body[0].expression,right:{type:o.NGValueParameter},operator:"="}}function v(a){return 0===a.body.length||1===a.body.length&&(a.body[0].expression.type===o.Literal||a.body[0].expression.type===o.ArrayExpression||a.body[0].expression.type===o.ObjectExpression)}function w(a){return a.constant}function x(a,b){this.astBuilder=a,this.$filter=b}function y(a,b){this.astBuilder=a,this.$filter=b}function E(a){this.form=a,this.valid=!1,this.invalid=!0,this.submitted=!1,this.validators=[],this.errors=[],this.data={}}function F(a){switch(typeof a){case"function":this.reducer=a;break;case"object":this.reducer=this.combineReducers(a);break;default:throw"Reducer must be a function or object given!"}this.listeners=[],this.state=null,this.dispatch()}var b=a("$parse"),c=function(a,b,c){if("[object Object]"===Object.prototype.toString.call(a))for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&b.call(c,a[d],d,a);else if(a)for(var e=0;e<a.length;e++)b.call(c,a[e],e,a)},d=function(){},e=function(a){return"undefined"!=typeof a},f=function(a){return"string"==typeof a},g=function(a){return"NaN"!==Number(a)},h=function(a){return a.toLocaleLowerCase()},l=({}.constructor.prototype.valueOf,i());"+ - * / % === !== == != < > <= >= && || ! = |".split(" ").map(function(a){l[a]=!0});var m={n:"\n",f:"\f",r:"\r",t:"\t",v:"\v","'":"'",'"':'"'},n=function(b){this.options=b};n.prototype={constructor:n,lex:function(a){for(this.text=a,this.index=0,this.tokens=[];this.index<this.text.length;){var b=this.text.charAt(this.index);if('"'===b||"'"===b)this.readString(b);else if(this.isNumber(b)||"."===b&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdentifierStart(this.peekMultichar()))this.readIdent();else if(this.is(b,"(){}[].,;:?"))this.tokens.push({index:this.index,text:b}),this.index++;else if(this.isWhitespace(b))this.index++;else{var c=b+this.peek(),d=c+this.peek(2),e=l[b],f=l[c],g=l[d];if(e||f||g){var h=g?d:f?c:b;this.tokens.push({index:this.index,text:h,operator:!0}),this.index+=h.length}else this.throwError("Unexpected next character ",this.index,this.index+1)}}return this.tokens},is:function(a,b){return b.indexOf(a)!==-1},peek:function(a){var b=a||1;return this.index+b<this.text.length&&this.text.charAt(this.index+b)},isNumber:function(a){return"0"<=a&&a<="9"&&"string"==typeof a},isWhitespace:function(a){return" "===a||"\r"===a||"\t"===a||"\n"===a||"\v"===a||"Â "===a},isIdentifierStart:function(a){return this.options.isIdentifierStart?this.options.isIdentifierStart(a,this.codePointAt(a)):this.isValidIdentifierStart(a)},isValidIdentifierStart:function(a){return"a"<=a&&a<="z"||"A"<=a&&a<="Z"||"_"===a||"$"===a},isIdentifierContinue:function(a){return this.options.isIdentifierContinue?this.options.isIdentifierContinue(a,this.codePointAt(a)):this.isValidIdentifierContinue(a)},isValidIdentifierContinue:function(a,b){return this.isValidIdentifierStart(a,b)||this.isNumber(a)},codePointAt:function(a){return 1===a.length?a.charCodeAt(0):(a.charCodeAt(0)<<10)+a.charCodeAt(1)-56613888},peekMultichar:function(){var a=this.text.charAt(this.index),b=this.peek();if(!b)return a;var c=a.charCodeAt(0),d=b.charCodeAt(0);return c>=55296&&c<=56319&&d>=56320&&d<=57343?a+b:a},isExpOperator:function(a){return"-"===a||"+"===a||this.isNumber(a)},throwError:function(a,c,d){d=d||this.index;var f=e(c)?"s "+c+"-"+this.index+" ["+this.text.substring(c,d)+"]":" "+d;throw b("lexerr","Lexer Error: {0} at column{1} in expression [{2}].",a,f,this.text)},readNumber:function(){for(var a="",b=this.index;this.index<this.text.length;){var c=h(this.text.charAt(this.index));if("."===c||this.isNumber(c))a+=c;else{var d=this.peek();if("e"===c&&this.isExpOperator(d))a+=c;else if(this.isExpOperator(c)&&d&&this.isNumber(d)&&"e"===a.charAt(a.length-1))a+=c;else{if(!this.isExpOperator(c)||d&&this.isNumber(d)||"e"!==a.charAt(a.length-1))break;this.throwError("Invalid exponent")}}this.index++}this.tokens.push({index:b,text:a,constant:!0,value:Number(a)})},readIdent:function(){var a=this.index;for(this.index+=this.peekMultichar().length;this.index<this.text.length;){var b=this.peekMultichar();if(!this.isIdentifierContinue(b))break;this.index+=b.length}this.tokens.push({index:a,text:this.text.slice(a,this.index),identifier:!0})},readString:function(a){var b=this.index;this.index++;for(var c="",d=a,e=!1;this.index<this.text.length;){var f=this.text.charAt(this.index);if(d+=f,e){if("u"===f){var g=this.text.substring(this.index+1,this.index+5);g.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+g+"]"),this.index+=4,c+=String.fromCharCode(parseInt(g,16))}else{var h=m[f];c+=h||f}e=!1}else if("\\"===f)e=!0;else{if(f===a)return this.index++,void this.tokens.push({index:b,text:d,constant:!0,value:c});c+=f}this.index++}this.throwError("Unterminated quote",b)}};var o=function(b,c){this.lexer=b,this.options=c};o.Program="Program",o.ExpressionStatement="ExpressionStatement",o.AssignmentExpression="AssignmentExpression",o.ConditionalExpression="ConditionalExpression",o.LogicalExpression="LogicalExpression",o.BinaryExpression="BinaryExpression",o.UnaryExpression="UnaryExpression",o.CallExpression="CallExpression",o.MemberExpression="MemberExpression",o.Identifier="Identifier",o.Literal="Literal",o.ArrayExpression="ArrayExpression",o.Property="Property",o.ObjectExpression="ObjectExpression",o.ThisExpression="ThisExpression",o.LocalsExpression="LocalsExpression",o.prototype={ast:function(a){this.text=a,this.tokens=this.lexer.lex(a);var b=this.program();return 0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]),b},program:function(){for(var a=[];;)if(this.tokens.length>0&&!this.peek("}",")",";","]")&&a.push(this.expressionStatement()),!this.expect(";"))return{type:o.Program,body:a}},expressionStatement:function(){return{type:o.ExpressionStatement,expression:this.filterChain()}},filterChain:function(){for(var a=this.expression();this.expect("|");)a=this.filter(a);return a},expression:function(){return this.assignment()},assignment:function(){var a=this.ternary();if(this.expect("=")){if(!t(a))throw b("lval","Trying to assign a value to a non l-value");a={type:o.AssignmentExpression,left:a,right:this.assignment(),operator:"="}}return a},ternary:function(){var b,c,a=this.logicalOR();return this.expect("?")&&(b=this.expression(),this.consume(":"))?(c=this.expression(),{type:o.ConditionalExpression,test:a,alternate:b,consequent:c}):a},logicalOR:function(){for(var a=this.logicalAND();this.expect("||");)a={type:o.LogicalExpression,operator:"||",left:a,right:this.logicalAND()};return a},logicalAND:function(){for(var a=this.equality();this.expect("&&");)a={type:o.LogicalExpression,operator:"&&",left:a,right:this.equality()};return a},equality:function(){for(var b,a=this.relational();b=this.expect("==","!=","===","!==");)a={type:o.BinaryExpression,operator:b.text,left:a,right:this.relational()};return a},relational:function(){for(var b,a=this.additive();b=this.expect("<",">","<=",">=");)a={type:o.BinaryExpression,operator:b.text,left:a,right:this.additive()};return a},additive:function(){for(var b,a=this.multiplicative();b=this.expect("+","-");)a={type:o.BinaryExpression,operator:b.text,left:a,right:this.multiplicative()};return a},multiplicative:function(){for(var b,a=this.unary();b=this.expect("*","/","%");)a={type:o.BinaryExpression,operator:b.text,left:a,right:this.unary()};return a},unary:function(){var a;return(a=this.expect("+","-","!"))?{type:o.UnaryExpression,operator:a.text,prefix:!0,argument:this.unary()}:this.primary()},primary:function(){var a;this.expect("(")?(a=this.filterChain(),this.consume(")")):this.expect("[")?a=this.arrayDeclaration():this.expect("{")?a=this.object():this.selfReferential.hasOwnProperty(this.peek().text)?a=copy(this.selfReferential[this.consume().text]):this.options.literals.hasOwnProperty(this.peek().text)?a={type:o.Literal,value:this.options.literals[this.consume().text]}:this.peek().identifier?a=this.identifier():this.peek().constant?a=this.constant():this.throwError("not a primary expression",this.peek());for(var b;b=this.expect("(","[",".");)"("===b.text?(a={type:o.CallExpression,callee:a,arguments:this.parseArguments()},this.consume(")")):"["===b.text?(a={type:o.MemberExpression,object:a,property:this.expression(),computed:!0},this.consume("]")):"."===b.text?a={type:o.MemberExpression,object:a,property:this.identifier(),computed:!1}:this.throwError("IMPOSSIBLE");return a},filter:function(a){for(var b=[a],c={type:o.CallExpression,callee:this.identifier(),arguments:b,filter:!0};this.expect(":");)b.push(this.expression());return c},parseArguments:function(){var a=[];if(")"!==this.peekToken().text)do a.push(this.filterChain());while(this.expect(","));return a},identifier:function(){var a=this.consume();return a.identifier||this.throwError("is not a valid identifier",a),{type:o.Identifier,name:a.text}},constant:function(){return{type:o.Literal,value:this.consume().value}},arrayDeclaration:function(){var a=[];if("]"!==this.peekToken().text)do{if(this.peek("]"))break;a.push(this.expression())}while(this.expect(","));return this.consume("]"),{type:o.ArrayExpression,elements:a}},object:function(){var b,a=[];if("}"!==this.peekToken().text)do{if(this.peek("}"))break;b={type:o.Property,kind:"init"},this.peek().constant?(b.key=this.constant(),b.computed=!1,this.consume(":"),b.value=this.expression()):this.peek().identifier?(b.key=this.identifier(),b.computed=!1,this.peek(":")?(this.consume(":"),b.value=this.expression()):b.value=b.key):this.peek("[")?(this.consume("["),b.key=this.expression(),this.consume("]"),b.computed=!0,this.consume(":"),b.value=this.expression()):this.throwError("invalid key",this.peek()),a.push(b)}while(this.expect(","));return this.consume("}"),{type:o.ObjectExpression,properties:a}},throwError:function(a,b){throw console.log("syntax","Syntax Error: Token '{0}' {1} at column {2} of the expression [{3}] starting at [{4}].",b.text,a,b.index+1,this.text,this.text.substring(b.index))},consume:function(a){if(0===this.tokens.length)throw b("ueoe","Unexpected end of expression: {0}",this.text);var c=this.expect(a);return c||this.throwError("is unexpected, expecting ["+a+"]",this.peek()),c},peekToken:function(){if(0===this.tokens.length)throw b("ueoe","Unexpected end of expression: {0}",this.text);return this.tokens[0]},peek:function(a,b,c,d){return this.peekAhead(0,a,b,c,d)},peekAhead:function(a,b,c,d,e){if(this.tokens.length>a){var f=this.tokens[a],g=f.text;if(g===b||g===c||g===d||g===e||!b&&!c&&!d&&!e)return f}return!1},expect:function(a,b,c,d){var e=this.peek(a,b,c,d);return!!e&&(this.tokens.shift(),e)},selfReferential:{this:{type:o.ThisExpression},$locals:{type:o.LocalsExpression}}},x.prototype={compile:function(a){var b=this,c=this.astBuilder.ast(a);this.state={nextId:0,filters:{},fn:{vars:[],body:[],own:{}},assign:{vars:[],body:[],own:{}},inputs:[]};var e,d="";if(this.stage="assign",e=u(c)){this.state.computing="assign";var f=this.nextId();this.recurse(e,f),this.return_(f),d="fn.assign="+this.generateFunction("assign","s,v,l")}b.stage="inputs",this.state.computing="fn",this.stage="main",this.recurse(c);var g='"'+this.USE+" "+this.STRICT+'";\n'+this.filterPrefix()+"var fn="+this.generateFunction("fn","s,l,a,i")+d+this.watchFns()+"return fn;",h=new Function("$filter","getStringValue","ifDefined","plus","text",g)(this.$filter,k,p,q,a);return this.state=this.stage=void 0,h.literal=v(c),h.constant=w(c),h},USE:"use",STRICT:"strict",watchFns:function(){var a=[],b=this.state.inputs,d=this;return c(b,function(b){a.push("var "+b+"="+d.generateFunction(b,"s"))}),b.length&&a.push("fn.inputs=["+b.join(",")+"];"),a.join("")},generateFunction:function(a,b){return"function("+b+"){"+this.varsPrefix(a)+this.body(a)+"};"},filterPrefix:function(){var a=[],b=this;return c(this.state.filters,function(c,d){a.push(c+"=$filter("+b.escape(d)+")")}),a.length?"var "+a.join(",")+";":""},varsPrefix:function(a){return this.state[a].vars.length?"var "+this.state[a].vars.join(",")+";":""},body:function(a){return this.state[a].body.join("")},recurse:function(a,b,f,g,h,i){var j,k,m,n,p,l=this;if(g=g||d,!i&&e(a.watchId))return b=b||this.nextId(),void this.if_("i",this.lazyAssign(b,this.computedMember("i",a.watchId)),this.lazyRecurse(a,b,f,g,h,!0));switch(a.type){case o.Program:c(a.body,function(b,c){l.recurse(b.expression,void 0,void 0,function(a){k=a}),c!==a.body.length-1?l.current().body.push(k,";"):l.return_(k)});break;case o.Literal:n=this.escape(a.value),this.assign(b,n),g(b||n);break;case o.UnaryExpression:this.recurse(a.argument,void 0,void 0,function(a){k=a}),n=a.operator+"("+this.ifDefined(k,0)+")",this.assign(b,n),g(n);break;case o.BinaryExpression:this.recurse(a.left,void 0,void 0,function(a){j=a}),this.recurse(a.right,void 0,void 0,function(a){k=a}),n="+"===a.operator?this.plus(j,k):"-"===a.operator?this.ifDefined(j,0)+a.operator+this.ifDefined(k,0):"("+j+")"+a.operator+"("+k+")",this.assign(b,n),g(n);break;case o.LogicalExpression:b=b||this.nextId(),l.recurse(a.left,b),l.if_("&&"===a.operator?b:l.not(b),l.lazyRecurse(a.right,b)),g(b);break;case o.ConditionalExpression:b=b||this.nextId(),l.recurse(a.test,b),l.if_(b,l.lazyRecurse(a.alternate,b),l.lazyRecurse(a.consequent,b)),g(b);break;case o.Identifier:b=b||this.nextId(),f&&(f.context="inputs"===l.stage?"s":this.assign(this.nextId(),this.getHasOwnProperty("l",a.name)+"?l:s"),f.computed=!1,f.name=a.name),l.if_("inputs"===l.stage||l.not(l.getHasOwnProperty("l",a.name)),function(){l.if_("inputs"===l.stage||"s",function(){h&&1!==h&&l.if_(l.isNull(l.nonComputedMember("s",a.name)),l.lazyAssign(l.nonComputedMember("s",a.name),"{}")),l.assign(b,l.nonComputedMember("s",a.name))})},b&&l.lazyAssign(b,l.nonComputedMember("l",a.name))),g(b);break;case o.MemberExpression:j=f&&(f.context=this.nextId())||this.nextId(),b=b||this.nextId(),l.recurse(a.object,j,void 0,function(){l.if_(l.notNull(j),function(){a.computed?(k=l.nextId(),l.recurse(a.property,k),l.getStringValue(k),h&&1!==h&&l.if_(l.not(l.computedMember(j,k)),l.lazyAssign(l.computedMember(j,k),"{}")),n=l.computedMember(j,k),l.assign(b,n),f&&(f.computed=!0,f.name=k)):(h&&1!==h&&l.if_(l.isNull(l.nonComputedMember(j,a.property.name)),l.lazyAssign(l.nonComputedMember(j,a.property.name),"{}")),n=l.nonComputedMember(j,a.property.name),l.assign(b,n),f&&(f.computed=!1,f.name=a.property.name))},function(){l.assign(b,"undefined")}),g(b)},!!h);break;case o.CallExpression:b=b||this.nextId(),a.filter?(k=l.filter(a.callee.name),m=[],c(a.arguments,function(a){var b=l.nextId();l.recurse(a,b),m.push(b)}),n=k+"("+m.join(",")+")",l.assign(b,n),g(b)):(k=l.nextId(),j={},m=[],l.recurse(a.callee,k,j,function(){l.if_(l.notNull(k),function(){c(a.arguments,function(b){l.recurse(b,a.constant?void 0:l.nextId(),void 0,function(a){m.push(a)})}),n=j.name?l.member(j.context,j.name,j.computed)+"("+m.join(",")+")":k+"("+m.join(",")+")",l.assign(b,n)},function(){l.assign(b,"undefined")}),g(b)}));break;case o.AssignmentExpression:k=this.nextId(),j={},this.recurse(a.left,void 0,j,function(){l.if_(l.notNull(j.context),function(){l.recurse(a.right,k),n=l.member(j.context,j.name,j.computed)+a.operator+k,
l.assign(b,n),g(b||n)})},1);break;case o.ArrayExpression:m=[],c(a.elements,function(b){l.recurse(b,a.constant?void 0:l.nextId(),void 0,function(a){m.push(a)})}),n="["+m.join(",")+"]",this.assign(b,n),g(b||n);break;case o.ObjectExpression:m=[],p=!1,c(a.properties,function(a){a.computed&&(p=!0)}),p?(b=b||this.nextId(),this.assign(b,"{}"),c(a.properties,function(a){a.computed?(j=l.nextId(),l.recurse(a.key,j)):j=a.key.type===o.Identifier?a.key.name:""+a.key.value,k=l.nextId(),l.recurse(a.value,k),l.assign(l.member(b,j,a.computed),k)})):(c(a.properties,function(b){l.recurse(b.value,a.constant?void 0:l.nextId(),void 0,function(a){m.push(l.escape(b.key.type===o.Identifier?b.key.name:""+b.key.value)+":"+a)})}),n="{"+m.join(",")+"}",this.assign(b,n)),g(b||n);break;case o.ThisExpression:this.assign(b,"s"),g(b||"s");break;case o.LocalsExpression:this.assign(b,"l"),g(b||"l");break;case o.NGValueParameter:this.assign(b,"v"),g(b||"v")}},getHasOwnProperty:function(a,b){var c=a+"."+b,d=this.current().own;return d.hasOwnProperty(c)||(d[c]=this.nextId(!1,a+"&&("+this.escape(b)+" in "+a+")")),d[c]},assign:function(a,b){if(a)return this.current().body.push(a,"=",b,";"),a},filter:function(a){return this.state.filters.hasOwnProperty(a)||(this.state.filters[a]=this.nextId(!0)),this.state.filters[a]},ifDefined:function(a,b){return"ifDefined("+a+","+this.escape(b)+")"},plus:function(a,b){return"plus("+a+","+b+")"},return_:function(a){this.current().body.push("return ",a,";")},if_:function(a,b,c){if(a===!0)b();else{var d=this.current().body;d.push("if(",a,"){"),b(),d.push("}"),c&&(d.push("else{"),c(),d.push("}"))}},not:function(a){return"!("+a+")"},isNull:function(a){return a+"==null"},notNull:function(a){return a+"!=null"},nonComputedMember:function(a,b){var c=/^[$_a-zA-Z][$_a-zA-Z0-9]*$/,d=/[^$_a-zA-Z0-9]/g;return c.test(b)?a+"."+b:a+'["'+b.replace(d,this.stringEscapeFn)+'"]'},computedMember:function(a,b){return a+"["+b+"]"},member:function(a,b,c){return c?this.computedMember(a,b):this.nonComputedMember(a,b)},getStringValue:function(a){this.assign(a,"getStringValue("+a+")")},lazyRecurse:function(a,b,c,d,e,f){var g=this;return function(){g.recurse(a,b,c,d,e,f)}},lazyAssign:function(a,b){var c=this;return function(){c.assign(a,b)}},stringEscapeRegex:/[^ a-zA-Z0-9]/g,stringEscapeFn:function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)},escape:function(a){if(f(a))return"'"+a.replace(this.stringEscapeRegex,this.stringEscapeFn)+"'";if(g(a))return a.toString();if(a===!0)return"true";if(a===!1)return"false";if(null===a)return"null";if("undefined"==typeof a)return"undefined";throw b("esc","IMPOSSIBLE")},nextId:function(a,b){var c="v"+this.state.nextId++;return a||this.current().vars.push(c+(b?"="+b:"")),c},current:function(){return this.state[this.state.computing]}},y.prototype={compile:function(a){var b=this,e=this.astBuilder.ast(a);this.expression=a;var f,g;(f=u(e))&&(g=this.recurse(f));var h=[];e.body.map(function(a){h.push(b.recurse(a.expression))});var i,j=0===e.body.length?d:1===e.body.length?h[0]:function(a,b){var d;return c(h,function(c){d=c(a,b)}),d};return g&&(j.assign=function(a,b,c){return g(a,c,b)}),i&&(j.inputs=i),j.literal=v(e),j.constant=w(e),j},recurse:function(a,b,d){var e,f,h,g=this;if(a.input)return this.inputs(a.input,a.watchId);switch(a.type){case o.Literal:return this.value(a.value,b);case o.UnaryExpression:return f=this.recurse(a.argument),this["unary"+a.operator](f,b);case o.BinaryExpression:return e=this.recurse(a.left),f=this.recurse(a.right),this["binary"+a.operator](e,f,b);case o.LogicalExpression:return e=this.recurse(a.left),f=this.recurse(a.right),this["binary"+a.operator](e,f,b);case o.ConditionalExpression:return this["ternary?:"](this.recurse(a.test),this.recurse(a.alternate),this.recurse(a.consequent),b);case o.Identifier:return g.identifier(a.name,b,d,g.expression);case o.MemberExpression:return e=this.recurse(a.object,!1,!!d),a.computed||(f=a.property.name),a.computed&&(f=this.recurse(a.property)),a.computed?this.computedMember(e,f,b,d,g.expression):this.nonComputedMember(e,f,b,d,g.expression);case o.CallExpression:return h=[],a.arguments.map(function(a){h.push(g.recurse(a))}),a.filter&&(f=this.$filter(a.callee.name)),a.filter||(f=this.recurse(a.callee,!0)),a.filter?function(a,c,d,e){for(var g=[],i=0;i<h.length;++i)g.push(h[i](a,c,d,e));var j=f.apply(void 0,g,e);return b?{context:void 0,name:void 0,value:j}:j}:function(a,c,d,e){var i,g=f(a,c,d,e);if(null!=g.value){for(var j=[],k=0;k<h.length;++k)j.push(h[k](a,c,d,e));i=g.value.apply(g.context,j)}return b?{value:i}:i};case o.AssignmentExpression:return e=this.recurse(a.left,!0,1),f=this.recurse(a.right),function(a,c,d,g){var h=e(a,c,d,g),i=f(a,c,d,g);return h.context[h.name]=i,b?{value:i}:i};case o.ArrayExpression:return h=[],c(a.elements,function(a){h.push(g.recurse(a))}),function(a,c,d,e){for(var f=[],g=0;g<h.length;++g)f.push(h[g](a,c,d,e));return b?{value:f}:f};case o.ObjectExpression:return h=[],c(a.properties,function(a){a.computed?h.push({key:g.recurse(a.key),computed:!0,value:g.recurse(a.value)}):h.push({key:a.key.type===o.Identifier?a.key.name:""+a.key.value,computed:!1,value:g.recurse(a.value)})}),function(a,c,d,e){for(var f={},g=0;g<h.length;++g)h[g].computed?f[h[g].key(a,c,d,e)]=h[g].value(a,c,d,e):f[h[g].key]=h[g].value(a,c,d,e);return b?{value:f}:f};case o.ThisExpression:return function(a){return b?{value:a}:a};case o.LocalsExpression:return function(a,c){return b?{value:c}:c};case o.NGValueParameter:return function(a,c,d){return b?{value:d}:d}}},"unary+":function(a,b){return function(c,d,f,g){var h=a(c,d,f,g);return h=e(h)?+h:0,b?{value:h}:h}},"unary-":function(a,b){return function(c,d,f,g){var h=a(c,d,f,g);return h=e(h)?-h:-0,b?{value:h}:h}},"unary!":function(a,b){return function(c,d,e,f){var g=!a(c,d,e,f);return b?{value:g}:g}},"binary+":function(a,b,c){return function(d,e,f,g){var h=a(d,e,f,g),i=b(d,e,f,g),j=q(h,i);return c?{value:j}:j}},"binary-":function(a,b,c){return function(d,f,g,h){var i=a(d,f,g,h),j=b(d,f,g,h),k=(e(i)?i:0)-(e(j)?j:0);return c?{value:k}:k}},"binary*":function(a,b,c){return function(d,e,f,g){var h=a(d,e,f,g)*b(d,e,f,g);return c?{value:h}:h}},"binary/":function(a,b,c){return function(d,e,f,g){var h=a(d,e,f,g)/b(d,e,f,g);return c?{value:h}:h}},"binary%":function(a,b,c){return function(d,e,f,g){var h=a(d,e,f,g)%b(d,e,f,g);return c?{value:h}:h}},"binary===":function(a,b,c){return function(d,e,f,g){var h=a(d,e,f,g)===b(d,e,f,g);return c?{value:h}:h}},"binary!==":function(a,b,c){return function(d,e,f,g){var h=a(d,e,f,g)!==b(d,e,f,g);return c?{value:h}:h}},"binary==":function(a,b,c){return function(d,e,f,g){var h=a(d,e,f,g)==b(d,e,f,g);return c?{value:h}:h}},"binary!=":function(a,b,c){return function(d,e,f,g){var h=a(d,e,f,g)!=b(d,e,f,g);return c?{value:h}:h}},"binary<":function(a,b,c){return function(d,e,f,g){var h=a(d,e,f,g)<b(d,e,f,g);return c?{value:h}:h}},"binary>":function(a,b,c){return function(d,e,f,g){var h=a(d,e,f,g)>b(d,e,f,g);return c?{value:h}:h}},"binary<=":function(a,b,c){return function(d,e,f,g){var h=a(d,e,f,g)<=b(d,e,f,g);return c?{value:h}:h}},"binary>=":function(a,b,c){return function(d,e,f,g){var h=a(d,e,f,g)>=b(d,e,f,g);return c?{value:h}:h}},"binary&&":function(a,b,c){return function(d,e,f,g){var h=a(d,e,f,g)&&b(d,e,f,g);return c?{value:h}:h}},"binary||":function(a,b,c){return function(d,e,f,g){var h=a(d,e,f,g)||b(d,e,f,g);return c?{value:h}:h}},"ternary?:":function(a,b,c,d){return function(e,f,g,h){var i=a(e,f,g,h)?b(e,f,g,h):c(e,f,g,h);return d?{value:i}:i}},value:function(a,b){return function(){return b?{context:void 0,name:void 0,value:a}:a}},identifier:function(a,b,c,d){return function(d,e,f,g){var h=e&&a in e?e:d;c&&1!==c&&h&&null==h[a]&&(h[a]={});var i=h?h[a]:void 0;return b?{context:h,name:a,value:i}:i}},computedMember:function(a,b,c,d,e){return function(e,f,g,h){var j,l,i=a(e,f,g,h);return null!=i&&(j=b(e,f,g,h),j=k(j),d&&1!==d&&i&&!i[j]&&(i[j]={}),l=i[j]),c?{context:i,name:j,value:l}:l}},nonComputedMember:function(a,b,c,d,e){return function(e,f,g,h){var i=a(e,f,g,h);d&&1!==d&&i&&null==i[b]&&(i[b]={});var j=null!=i?i[b]:void 0;return c?{context:i,name:b,value:j}:j}},inputs:function(a,b){return function(c,d,e,f){return f?f[b]:a(c,d,e)}}};var z=function(b,c,d){this.lexer=b,this.$filter=c,this.options=d,this.ast=new o(b,d),this.astCompiler=d.cps?new y(this.ast,c):new x(this.ast,c)};z.prototype={constructor:z,parse:function(a){return this.astCompiler.compile(a)}};var B=B||function(){var a={},b=function(a){for(var d,b=a.attributes,c=[],e=0;e<b.length;e+=1)(d=C.get(b[e].name+"_Drcv"))&&c.push({name:b[e].name,value:b[e].value,priority:d.priority||0});return c.sort(function(a,b){return a.priority>b.priority?-1:a.priority<b.priority?1:0})};return{bootstrap:function(){this.compile(document.children[0],{}),this.onInit.map(function(a){a()})},onInit:[],compile:function(a,c){var e,d=b(a),c=c||null;if(!a.classList.contains("isolate-scope")){d.forEach(function(b){e=C.get(b.name+"_Drcv"),e.scope&&(c=C.get(b.value+"_Ctrl")||{}),"data-controller"===b.name&&(this.currentController=b.value,"function"==typeof c.onInit&&this.onInit.push(c.onInit.bind(c))),a.compiled||(e.controller=this.currentController),!a.compiled&&e.compiler&&e.compiler(c,a,b.value),e.linker&&e.linker(c,a,b.value)},this),a.compiled=!0;var f=Array.prototype.slice.call(a.children).map(function(a){return a});f.forEach(function(a){this.compile(a,c)},this),this.interpolate(a,c)}},interpolatedKey:0,interpolate:function(b,c){var d=this;b.childNodes.forEach(function(b){var e=d.interpolatedKey;3===b.nodeType&&("undefined"!=typeof b.$bindKey&&(b.nodeValue=a[b.$bindKey]),null===b.nodeValue.match(/\{\{(.*?)\}\}/g)||b.$bindKey||(b.$bindKey=e,a[b.$bindKey]=b.nodeValue,d.interpolatedKey++),b.nodeValue=b.nodeValue.replace(/\{\{(.*?)\}\}/g,function(a,b){return C.interpolate(b,c)}))})}}}(),C=C||function(){var a={},b={},c={csp:!1,literals:{true:!0,false:!1,null:null,undefined:void 0},isIdentifierStart:"function"==typeof identStart&&identStart,isIdentifierContinue:"function"==typeof identContinue&&identContinue},d=new n(c),e=new z(d,!1,c);return{register:function(b,c){return c?(a[b]||(a[b]=c),a[b]):null},serviceRegister:function(a,b){this.register(a,b)},controller:function(a,b){this.register(a+"_Ctrl",b)},directive:function(a,b){this.register(a+"_Drcv",b)},service:function(a,b){this.serviceRegister(a,b)},get:function(c){return"undefined"!=typeof a[c]&&(b[c]||(b[c]=this.inject(a[c])),b[c])},inject:function(a){function c(){return a.apply(this,b)}var b=[];return a.hasOwnProperty("$inject")?(a.$inject.forEach(function(a){b.push(this.get(a))},this),c.prototype=a.prototype,new c):new a},interpolate:function(a,b){return e.parse(a)("string"==typeof b?this.get(b+"_Ctrl"):b)},parser:function(a,b,c){var d,f,g=b.match(/(.*)\((.*)\)/),h=b.replace(/\((.*)\)/,""),i=b.match(/\((.*)\)/);return null===g?e.parse(b,a)(a):(null===i&&(i=i.split(",")),"function"!=typeof a[h]?(f=e.parse(h))(a):(d=i&&i[1].indexOf("event"),i=i[1].split(",").map(function(b){return"event"===String(b).toLocaleLowerCase().trim()?b:e.parse(b)(a)}),d!==-1&&(i[d]=c),a[h].apply(a,i)))}}}();C.directive("data-controller",function(){return{scope:!0,linker:function(a,b,c){this.scope=C.get(c+"_Ctrl"),this.scope.refreshView=function(){B.compile(b,a)}}}});var D="click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress focus blur copy cut paste".split(" ");return D.forEach(function(a){var b="data-"+a;C.directive(b,function(){return{scope:!1,compiler:function(c,d){var f=d.getAttribute(b);d.addEventListener(a,function(a){C.parser(c,f,a)})}}})}),C.directive("data-change",function(){return{scope:!1,compiler:function(a,b,c){var e=document.querySelector('[data-controller="'+this.controller+'"]');b.addEventListener("change",function(b){C.parser(a,c,b),B.compile(e)})}}}),C.directive("data-form-data",function(){return{scope:!1,priority:100,compiler:function(a,b,c){var e=a[c]||{};document.querySelector('[data-controller="'+this.controller+'"]');if(a[b.getAttribute("name")]){if("function"==typeof e&&(e=e()),"[object Object]"!==e.toString())return;a[b.getAttribute("name")].populate(e)}}}}),C.directive("data-submit",function(){var b,c,a={};return c=function(a){var c=[],d={},e=a.querySelectorAll("[data-form-group]");return e.forEach(function(e,f){var g=e.getAttribute("data-form-group");c[g]={},e.querySelectorAll("[name]").forEach(function(e){c[g][e.name]=b(e,a),d[e.name]=g})}),{inputGroups:c,inGroup:d}},b=function(b,c){switch(b.type){case"radio":return a[b.name]=b.checked?b.value:a[b.name];case"checkbox":return a[b.name]=a[b.name]||[],b.checked&&a[b.name].push(b.value),c.elements[b.name].length?a[b.name]:a[b.name].join("");default:return b.value}},{scope:!1,priority:200,compiler:function(d,e,f){var i,j=(document.querySelector('[data-controller="'+this.controller+'"]'),c(e)),k=new E(e);null===(i=e.getAttribute("name"))&&(i="form_"+Math.floor(1e3*Math.random())+1,e.setAttribute("name",i)),d[i]=k,e.addEventListener("submit",function(c){for(var h=(c.target.name,{}),i=0;i<e.elements.length;i++){var l=e.elements[i].name;""!==l.trim()&&("undefined"==typeof j.inGroup[l]?h[e.elements[i].name]=b(e.elements[i],e):h[j.inGroup[l]]=j.inputGroups[j.inGroup[l]])}k.submitted=!0,k.data=h,k.validate(),a={},C.parser(d,f,c),c.preventDefault()})}}}),C.directive("data-class",function(){var a=function(a,b){Object.keys(a).forEach(function(c){a[c]?b.classList.add(c):b.classList.remove(c)})};return{recall:!0,scope:!1,linker:function(b,c,d){var g=(document.querySelector('[data-controller="'+this.controller+'"]'),C.parser(b,d));Array.isArray(g)&&g.forEach(function(b){"string"==typeof b&&c.classList.add(b),"object"==typeof b&&a(b,c)}),Array.isArray(g)||"object"!=typeof g||a(g,c)}}}),C.directive("data-if",function(){return{scope:!1,expressions:[],compiler:function(a,b,c){var d=b.cloneNode(!0),e=document.createComment(" dataIf ");b.parentNode.insertBefore(e,b),b.remove(),this.expressions.push(function(){var f=C.parser(a,c);d.$uniqKey=b.$uniqKey,d.removeAttribute("data-if"),f?(e.parentNode.insertBefore(d,e.nextSibling),B.compile(d,a)):d.remove(),d.setAttribute("data-if",c)})},linker:function(a,b,c){this.expressions.forEach(function(a){a()})}}}),C.directive("data-model",function(){var a;return{scope:!1,compiler:function(b,c,d){a=a||document.querySelector('[data-controller="'+this.controller+'"]'),c.addEventListener("keyup",function(c){var e;switch(typeof c.target.value){case"string":e='"'+c.target.value+'"';break;default:e=c.target.value}C.parser(b,d+"="+e),B.compile(a)})}}}),C.directive("data-repeat",function(){return{scope:!1,compiler:function(a,b){function s(b){for(var c=q,e=[],h=[],k=0;k<b.length;k++){var l=b[k],m={},n=f.cloneNode(!0),o=i!==!1?"undefined"==typeof l[i]?k:l[i]:k;if(m[j]=l,n.removeAttribute("data-repeat"),h.indexOf(o)!==-1)throw"Duplicates in a repeater are not allowed. Repeater: "+g;if(h[k]=o,e[o]={el:n,scope:m},o in d){var p=_.values(e[o].scope)[0],r=_.values(d[o].scope)[0];if(!_.isEqual(p,r)){for(;d[o].el.firstChild;)d[o].el.firstChild.remove();d[o].el.remove(),d[o]=e[o]}}else d[o]={el:n,scope:m}}for(var k=0;k<=d.length;k++)if(h.indexOf(k)===-1&&d[k]){for(;d[k].el.firstChild;)d[k].el.firstChild.remove();d[k].el.remove(),delete d[k]}for(var k=0;k<h.length;k++){var s=h[k];c.parentNode.insertBefore(d[s].el,c.nextSibling),d[s].el.classList.contains("isolate-scope")||(B.compile(d[s].el,Object.setPrototypeOf(d[s].scope,a)),d[s].el.classList.add("isolate-scope")),c=d[s].el}}var d=[],f=b.cloneNode(!0),g=b.getAttribute("data-repeat"),h=b.getAttribute("data-repeat").split(" "),i=g.indexOf("track by")!==-1&&g.split(" track by ")[1],j=h[0],k=h[2],l=a[k]||[],o=(b.parentNode,b.getAttribute("data-store")),p=a[o]||!1,q=document.createComment(" dataRepeat "),r=g.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/);if(!r)throw"Expected expression in form of '"+j+" in "+k+"[ track by _id_]' but got '"+g+"'.";b.parentNode.insertBefore(q,b),b.remove(),p!==!1&&p.subscribe(function(){s(p.getState())}),s(l)}}}),E.prototype.validate=function(){var a,b="";this.errors=[],this.valid=!0,this.invalid=!1;for(var c=0;c<this.form.elements.length;c++)if(this.form.elements[c].classList.remove("has-error","required"),this.form.elements[c].required&&0===this.form.elements[c].value.length&&(this.form.elements[c].classList.add("has-error","required"),this.errors.push({name:this.form.elements[c].name,error:"This field is required and cannot be empty!"})),this.form.elements[c].getAttribute("pattern")&&this.form.elements[c].getAttribute("pattern").length>0)a=this.form.elements[c].getAttribute("pattern"),b=new RegExp("^"+a+"$"),b.test(this.form.elements[c].value)||(this.form.elements[c].classList.add("has-error"),this.errors.push({name:this.form.elements[c].name,error:"Value is invalid, does not mutch the correct pattern!"}));else{var d="";switch(b="",this.form.elements[c].type){case"number":b=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))([eE][+-]?\d+)?\s*$/,d="The Number is invalid!";break;case"email":b=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/i,d="The email address is invalid!";break;case"date":b=/^(\d{4,})-(\d{2})-(\d{2})$/,d="The Date value is invalid!";break;case"datetime":b=/^(\d{4,})-(\d\d)-(\d\d)T(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,d="The DateTime value is invalid!";break;case"color":b=/^#([0-9a-f]{3}){1,2}$/i,d="The Color value is invalid!";break;case"url":b=/[-a-zA-Z0-9@:%_\+.~#?&\/\/=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)?/gi,d="The URL address is invalid!"}b&&b.test(this.form.elements[c].value)===!1&&(this.form.elements[c].classList.add("has-error"),this.errors.push({name:this.form.elements[c].name,error:d,type:this.form.elements[c].type}))}this.validators.length>0&&this.validators.forEach(function(a){var b=this.form.elements[a.name];if(b){if(!Array.isArray(a.validators))throw"Validators should be array given "+typeof a.validators+"!";a.validators.forEach(function(c){c.validator(b)===!1&&this.errors.push({name:a.name,message:c.message||"",type:b.type})},this)}},this),this.errors.length>0&&(this.valid=!1,this.invalid=!0)},E.prototype.addValidator=function(a){if("[object Object]"!==a.toString())throw"Validator should be object given "+typeof a+"!";this.validators.push(a)},E.prototype.clear=function(){for(var a=0;a<this.form.elements.length;a++)"checkbox"!==this.form.elements[a].type&&"radio"!==this.form.elements[a].type?this.form.elements[a].value="":this.form.elements[a].checked=!1},E.prototype.populate=function(a){var b={},c=a||{};if("FORM"===this.form.tagName&&"object"==typeof c&&Object.keys(c).length){Object.keys(c).forEach(function(a){"object"!=typeof c[a]||Array.isArray(c[a])?b[a]=c[a]:Object.keys(c[a]).forEach(function(d){b[d]=c[a][d]})});for(var d=0;d<this.form.elements.length;d++)if("undefined"!=typeof b[this.form.elements[d].name])if("radio"!==this.form.elements[d].type||this.form.elements[d].value!==b[this.form.elements[d].name]){if("checkbox"===this.form.elements[d].type){var e=Array.isArray(b[this.form.elements[d].name]);if(e&&0===b[this.form.elements[d].name].length)continue;if(e&&b[this.form.elements[d].name].indexOf(this.form.elements[d].value)!==-1){this.form.elements[d].checked=!0;continue}if(!e&&this.form.elements[d].value===b[this.form.elements[d].name]){this.form.elements[d].checked=!0;continue}}this.form.elements[d].value=b[this.form.elements[d].name]}else this.form.elements[d].checked=!0}},F.prototype.dispatch=function(a){this.state=this.reducer(this.state,a),this.listeners.forEach(function(a){a()})},F.prototype.getState=function(){return this.state},F.prototype.setState=function(a){return Array.isArray(a)?this.state=a.slice(0):Array.isArray(a)||"object"!=typeof a?this.state=a:this.state=Object.assign({},a),this},F.prototype.subscribe=function(a){var b=this;return this.listeners.push(a),function(){b.listeners=b.listeners.filter(function(b){return b!==a})}},F.prototype.combineReducers=function(a){return function(b,c){return b=b||{},Object.keys(a).reduce(function(d,e){return d[e]=a[e](b[e],c),d},{})}},{bootstrap:B.bootstrap.bind(B),controller:C.controller.bind(C),directive:C.directive.bind(C),service:C.service.bind(C),store:F}}(vejs||{});
